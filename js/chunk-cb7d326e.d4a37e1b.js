(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cb7d326e"],{"19cc":function(e,t,a){},"4ba2":function(e,t,a){var o=a("2ea2"),r=a("2f77"),l=a("69b3"),n=a("e7ad").Reflect;e.exports=n&&n.ownKeys||function(e){var t=o.f(l(e)),a=r.f;return a?t.concat(a(e)):t}},"5ab2":function(e,t,a){var o=a("e46b"),r=a("4ba2"),l=a("09b9"),n=a("dcb7"),i=a("ebc3");o(o.S,"Object",{getOwnPropertyDescriptors:function(e){var t,a,o=l(e),s=n.f,c=r(o),m={},u=0;while(c.length>u)a=s(o,t=c[u++]),void 0!==a&&i(m,t,a);return m}})},"5e48":function(e,t,a){"use strict";var o=a("19cc"),r=a.n(o);r.a},a02a:function(e,t,a){"use strict";var o=a("c208"),r=a.n(o);r.a},a77f:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[e._v("coupon制作")])]),a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.actTab,callback:function(t){e.actTab=t},expression:"actTab"}},[a("el-tab-pane",{attrs:{name:"createId",label:"新增礼包ID"}},[a("create-id",{attrs:{oriTab:e.actTab}})],1),a("el-tab-pane",{attrs:{name:"createCode",label:"新增礼包码"}},[a("create-code",{attrs:{oriTab:e.actTab}})],1),a("el-tab-pane",{attrs:{name:"codeShow",label:"礼包码查询"}},[a("code-show",{attrs:{oriTab:e.actTab}})],1),a("el-tab-pane",{attrs:{name:"idUpdate",label:"礼包ID查询修改"}},[a("id-update",{attrs:{oriTab:e.actTab}})],1),a("el-tab-pane",{attrs:{name:"idList",label:"礼包"}},[a("id-list",{attrs:{oriTab:e.actTab}})],1)],1)],1)},r=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"objForm",attrs:{model:e.objForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"礼包ID",prop:"id"}},[a("el-input",{attrs:{placeholder:"请输入礼包ID"},model:{value:e.objForm.id,callback:function(t){e.$set(e.objForm,"id",t)},expression:"objForm.id"}})],1),a("el-form-item",{attrs:{label:"礼包内容"}},[a("el-button",{on:{click:function(t){return t.preventDefault(),e.addItem(t)}}},[e._v("添加")])],1),e._l(e.objForm.items,(function(t,o){return a("el-row",{key:o,staticStyle:{marginTop:"10px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:1,offset:2}},[a("span",{staticStyle:{lineHeight:"40px"}},[e._v(e._s(o+1))])]),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"道具",prop:"items."+o+".itemId","label-width":"60px",rules:{required:!0,message:"道具不能为空",trigger:"blur"}}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择道具"},model:{value:t.itemId,callback:function(a){e.$set(t,"itemId",a)},expression:"item.itemId"}},e._l(e.aItemList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.type+"-"+e.name,value:e.itemId}})})),1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"数量",prop:"items."+o+".num","label-width":"60px",rules:{required:!0,message:"数量不能为空",trigger:"blur"}}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:t.num,callback:function(a){e.$set(t,"num",a)},expression:"item.num"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{on:{click:function(a){return a.preventDefault(),e.removeItem(t)}}},[e._v("删除")])],1)],1)})),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("objForm")}}},[e._v("创建礼包ID")])],1)],2)],1)},n=[],i={name:"create-id",props:{oriTab:{type:String,default:"create"}},data:function(){return{aItemList:[],objForm:{id:"",items:[{itemId:"",num:1}]},rules:{id:[{required:!0,message:"请输入id",trigger:"blur"}]}}},watch:{oriTab:{handler:function(){"createId"==this.oriTab&&this.fetchItemList()}}},methods:{removeItem:function(e){var t=this.objForm.items.indexOf(e);-1!==t&&this.objForm.items.splice(t,1)},addItem:function(){this.objForm.items.push({itemId:"",num:1})},submitForm:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;var o=JSON.parse(JSON.stringify(t.objForm));t.$fetch.post(API.coupon.create_coupon_id,o).then((function(a){var o=a.data;200==o.status?(t.$refs[e].resetFields(),t.$message.success(o.desc)):t.$message.error(o.desc)}))}))},fetchItemList:function(){var e=this;this.$fetch.post(API.email.item_list).then((function(t){var a=t.data;200==a.status?e.aItemList=a.data:e.$message.error(a.desc)}))}},mounted:function(){this.fetchItemList()}},s=i,c=a("4e82"),m=Object(c["a"])(s,l,n,!1,null,null,null),u=m.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"objFormEmailSingle",attrs:{model:e.objFormEmailSingle,rules:e.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"平台",prop:"platform"}},[a("el-select",{attrs:{placeholder:"请选择平台"},model:{value:e.objFormEmailSingle.platform,callback:function(t){e.$set(e.objFormEmailSingle,"platform",t)},expression:"objFormEmailSingle.platform"}},e._l(e.aPlatform,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.objFormEmailSingle.name,callback:function(t){e.$set(e.objFormEmailSingle,"name",t)},expression:"objFormEmailSingle.name"}})],1),a("el-form-item",{attrs:{label:"分类信息",prop:"describe"}},[a("el-input",{attrs:{placeholder:"请输入分类信息"},model:{value:e.objFormEmailSingle.describe,callback:function(t){e.$set(e.objFormEmailSingle,"describe",t)},expression:"objFormEmailSingle.describe"}})],1),a("el-form-item",{attrs:{label:"生成数量",prop:"num"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.objFormEmailSingle.num,callback:function(t){e.$set(e.objFormEmailSingle,"num",t)},expression:"objFormEmailSingle.num"}})],1),a("el-form-item",{attrs:{label:"使用最低等级",prop:"minLevel"}},[a("el-input",{attrs:{placeholder:"请输入使用最低等级"},model:{value:e.objFormEmailSingle.minLevel,callback:function(t){e.$set(e.objFormEmailSingle,"minLevel",t)},expression:"objFormEmailSingle.minLevel"}})],1),a("el-form-item",{attrs:{label:"使用最高等级",prop:"maxLevel"}},[a("el-input",{attrs:{placeholder:"请输入使用最高等级"},model:{value:e.objFormEmailSingle.maxLevel,callback:function(t){e.$set(e.objFormEmailSingle,"maxLevel",t)},expression:"objFormEmailSingle.maxLevel"}})],1),a("el-form-item",{attrs:{label:"生效日期",prop:"start"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择生效日期"},model:{value:e.objFormEmailSingle.start,callback:function(t){e.$set(e.objFormEmailSingle,"start",t)},expression:"objFormEmailSingle.start"}})],1),a("el-form-item",{attrs:{label:"失效日期",prop:"end"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择失效日期"},model:{value:e.objFormEmailSingle.end,callback:function(t){e.$set(e.objFormEmailSingle,"end",t)},expression:"objFormEmailSingle.end"}})],1),a("el-form-item",{attrs:{label:"邮件标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入邮件标题"},model:{value:e.objFormEmailSingle.title,callback:function(t){e.$set(e.objFormEmailSingle,"title",t)},expression:"objFormEmailSingle.title"}})],1),a("el-form-item",{attrs:{label:"邮件内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入邮件内容"},model:{value:e.objFormEmailSingle.content,callback:function(t){e.$set(e.objFormEmailSingle,"content",t)},expression:"objFormEmailSingle.content"}})],1),a("el-form-item",{attrs:{label:"礼包",prop:"couponId"}},[a("el-select",{attrs:{placeholder:"请选择礼包"},model:{value:e.objFormEmailSingle.couponId,callback:function(t){e.$set(e.objFormEmailSingle,"couponId",t)},expression:"objFormEmailSingle.couponId"}},e._l(e.aCouponId,(function(e,t){return a("el-option",{key:t,attrs:{label:e.id,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"分发客户端",prop:"channels"}},[a("el-checkbox-group",{model:{value:e.objFormEmailSingle.channels,callback:function(t){e.$set(e.objFormEmailSingle,"channels",t)},expression:"objFormEmailSingle.channels"}},e._l(e.aChannels,(function(t,o){return a("el-checkbox",{key:o,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"礼包类型"}},[a("el-radio-group",{attrs:{prop:"type"},model:{value:e.objFormEmailSingle.type,callback:function(t){e.$set(e.objFormEmailSingle,"type",t)},expression:"objFormEmailSingle.type"}},[a("p",[a("el-radio",{attrs:{label:"1"}},[e._v("普通类型")]),a("span",[e._v("1个礼包码，1个账号只能使用1次、该类礼包1个账号只能使用其中1个")])],1),a("p",[a("el-radio",{attrs:{label:"2"}},[e._v("万能类型")]),a("span",[e._v("1个礼包码，N个账号只能使用1次、该类礼包1个账号只能使用其中1个")])],1),a("p",[a("el-radio",{attrs:{label:"3"}},[e._v("福利类型")]),a("span",[e._v("1个礼包码，1个账号只能使用1次、该类礼包1个账号只能使用其中N个")])],1)])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("objFormEmailSingle")}}},[e._v("创建礼包码")])],1)],1)],1)},d=[],b={name:"coupon-createCode",props:{oriTab:{type:String,default:"create"}},data:function(){return{aCouponId:[],aChannels:[{id:1,name:"A服"},{id:2,name:"B服"},{id:3,name:"C服"}],aPlatform:[{id:101,name:"平台1"},{id:102,name:"平台2"}],objFormEmailSingle:{platform:"",name:"",describe:"",num:0,minLevel:"",maxLevel:"",start:"",end:"",title:"",content:"",couponId:"",channels:[],type:"1"},rules:{platform:[{required:!0,message:"请选择平台",trigger:"change"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],describe:[{required:!0,message:"请输入分类信息",trigger:"blur"}],num:[{required:!0,message:"请输入数量"}],minLevel:[{required:!0,message:"请输入使用最低等级",trigger:"blur"}],maxLevel:[{required:!0,message:"请输入使用最高等级",trigger:"blur"}],start:[{required:!0,message:"请选择时间",trigger:"change"}],end:[{required:!0,message:"请选择时间",trigger:"change"}],title:[{required:!0,message:"请输入邮件标题",trigger:"blur"}],content:[{required:!0,message:"请输入邮件内容",trigger:"blur"}],couponId:[{required:!0,message:"请选择礼包",trigger:"change"}],channels:[{required:!0,message:"请选择分发客户端",trigger:"change"}],type:[{required:!0,message:"请选择礼包类型",trigger:"change"}]}}},watch:{oriTab:{handler:function(){"createCode"==this.oriTab&&(this.fetchPlatformList(),this.fetchChannelList(),this.fetchCouponIdList())}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;var o=JSON.parse(JSON.stringify(t.objFormEmailSingle));t.$fetch.post(API.coupon.create_coupon_code,o).then((function(a){var o=a.data;200==o.status?(t.$refs[e].resetFields(),t.$message.success("创建成功 礼包批次号为：【".concat(o.data.sequenceId,"】"))):t.$message.error(o.desc)}))}))},fetchPlatformList:function(){var e=this;this.$fetch.post(API.coupon.platform_list).then((function(t){var a=t.data;200==a.status?e.aPlatform=a.data:e.$message.error(a.desc)}))},fetchChannelList:function(){var e=this;this.$fetch.post(API.anno.channels).then((function(t){var a=t.data;200==a.status?e.aChannels=a.data:e.$message.error(a.desc)}))},fetchCouponIdList:function(){var e=this;this.$fetch.post(API.coupon.coupon_id_list).then((function(t){var a=t.data;200==a.status&&(e.aCouponId=a.data)}))}},mounted:function(){this.fetchPlatformList(),this.fetchChannelList(),this.fetchCouponIdList()}},f=b,h=Object(c["a"])(f,p,d,!1,null,null,null),g=h.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-form",{attrs:{model:e.objSearch,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"礼包批次号"}},[a("el-input",{attrs:{placeholder:"请输入礼包批次号"},model:{value:e.objSearch.sequenceId,callback:function(t){e.$set(e.objSearch,"sequenceId",t)},expression:"objSearch.sequenceId"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"平台"}},[a("el-input",{attrs:{placeholder:"请输入平台"},model:{value:e.objSearch.platform,callback:function(t){e.$set(e.objSearch,"platform",t)},expression:"objSearch.platform"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"礼包类型"}},[a("el-input",{attrs:{placeholder:"请输入礼包类型"},model:{value:e.objSearch.type,callback:function(t){e.$set(e.objSearch,"type",t)},expression:"objSearch.type"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.aTableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"sequenceId",label:"礼包批次号","min-width":"100"}}),a("el-table-column",{attrs:{prop:"type",label:"礼包类型","min-width":"80","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"couponId",label:"礼包ID","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"describe",label:"分类信息","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"end",label:"过期时间","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"appendTime",label:"追加时间","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"num",label:"总量","min-width":"70","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"useNum",label:"已使用","min-width":"70","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"noUseNum",label:"未使用","min-width":"70","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.num-t.row.useNum))])]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handleClickUpdate(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handleClickTime(t.row)}}},[e._v("追加时间")]),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handleClickNum(t.row)}}},[e._v("追加数量")]),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handleClickDownload(t.row)}}},[e._v("下载")])]}}])})],1),a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","current-page":e.objPager.currentPage,"page-size":e.objPager.pageSize,total:e.objPager.total},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){return e.$set(e.objPager,"currentPage",t)},"update:current-page":function(t){return e.$set(e.objPager,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.objPager,"pageSize",t)},"update:page-size":function(t){return e.$set(e.objPager,"pageSize",t)}}})],1),a("el-dialog",{attrs:{title:"修改礼包码",visible:e.bDialogUpdate,width:"800px"},on:{"update:visible":function(t){e.bDialogUpdate=t}}},[a("code-update",{attrs:{formData:e.objSingle},on:{submitUpdate:e.handleClickSubmitUpdate}})],1),a("el-dialog",{attrs:{title:"追加时间",visible:e.bDialogTime,width:"400px"},on:{"update:visible":function(t){e.bDialogTime=t}}},[a("el-form",{attrs:{model:e.objTime,rules:e.objRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"礼包批次号"}},[a("p",[e._v(e._s(e.objTime.sequenceId))])]),a("el-form-item",{attrs:{label:"追加时间",prop:"appendTime"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择追加时间"},model:{value:e.objTime.appendTime,callback:function(t){e.$set(e.objTime,"appendTime",t)},expression:"objTime.appendTime"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleClickSubmitTime}},[e._v("确认追加")])],1)],1)],1),a("el-dialog",{attrs:{title:"追加数量",visible:e.bDialogNum,width:"400px"},on:{"update:visible":function(t){e.bDialogNum=t}}},[a("el-form",{attrs:{model:e.objNum,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"礼包批次号"}},[a("p",[e._v(e._s(e.objNum.sequenceId))])]),a("el-form-item",{attrs:{label:"追加数量"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.objNum.appendNum,callback:function(t){e.$set(e.objNum,"appendNum",t)},expression:"objNum.appendNum"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleClickSubmitNum}},[e._v("确认追加")])],1)],1)],1)],1)},j=[],S=(a("5ab2"),a("e10e"),a("f010")),y=(a("6d57"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"objFormSingle",attrs:{model:e.objFormSingle,rules:e.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"平台",prop:"platform"}},[a("el-select",{attrs:{placeholder:"请选择平台"},model:{value:e.objFormSingle.platform,callback:function(t){e.$set(e.objFormSingle,"platform",t)},expression:"objFormSingle.platform"}},e._l(e.aPlatform,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.objFormSingle.name,callback:function(t){e.$set(e.objFormSingle,"name",t)},expression:"objFormSingle.name"}})],1),a("el-form-item",{attrs:{label:"分类信息",prop:"describe"}},[a("el-input",{attrs:{placeholder:"请输入分类信息"},model:{value:e.objFormSingle.describe,callback:function(t){e.$set(e.objFormSingle,"describe",t)},expression:"objFormSingle.describe"}})],1),a("el-form-item",{attrs:{label:"生成数量",prop:"num"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.objFormSingle.num,callback:function(t){e.$set(e.objFormSingle,"num",t)},expression:"objFormSingle.num"}})],1),a("el-form-item",{attrs:{label:"使用最低等级",prop:"minLevel"}},[a("el-input",{attrs:{placeholder:"请输入使用最低等级"},model:{value:e.objFormSingle.minLevel,callback:function(t){e.$set(e.objFormSingle,"minLevel",t)},expression:"objFormSingle.minLevel"}})],1),a("el-form-item",{attrs:{label:"使用最高等级",prop:"maxLevel"}},[a("el-input",{attrs:{placeholder:"请输入使用最高等级"},model:{value:e.objFormSingle.maxLevel,callback:function(t){e.$set(e.objFormSingle,"maxLevel",t)},expression:"objFormSingle.maxLevel"}})],1),a("el-form-item",{attrs:{label:"生效日期",prop:"start"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择生效日期"},model:{value:e.objFormSingle.start,callback:function(t){e.$set(e.objFormSingle,"start",t)},expression:"objFormSingle.start"}})],1),a("el-form-item",{attrs:{label:"失效日期",prop:"end"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择失效日期"},model:{value:e.objFormSingle.end,callback:function(t){e.$set(e.objFormSingle,"end",t)},expression:"objFormSingle.end"}})],1),a("el-form-item",{attrs:{label:"邮件标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.objFormSingle.title,callback:function(t){e.$set(e.objFormSingle,"title",t)},expression:"objFormSingle.title"}})],1),a("el-form-item",{attrs:{label:"邮件内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.objFormSingle.content,callback:function(t){e.$set(e.objFormSingle,"content",t)},expression:"objFormSingle.content"}})],1),a("el-form-item",{attrs:{label:"礼包",prop:"couponId"}},[a("el-select",{attrs:{placeholder:"请选择礼包"},model:{value:e.objFormSingle.couponId,callback:function(t){e.$set(e.objFormSingle,"couponId",t)},expression:"objFormSingle.couponId"}},e._l(e.aCoupon,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"分发客户端",prop:"channels"}},[a("el-checkbox-group",{model:{value:e.objFormSingle.channels,callback:function(t){e.$set(e.objFormSingle,"channels",t)},expression:"objFormSingle.channels"}},e._l(e.aChannels,(function(t,o){return a("el-checkbox",{key:o,attrs:{label:t.id+""}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"礼包类型"}},[a("el-radio-group",{attrs:{prop:"type"},model:{value:e.objFormSingle.type,callback:function(t){e.$set(e.objFormSingle,"type",t)},expression:"objFormSingle.type"}},[a("p",[a("el-radio",{attrs:{label:"1"}},[e._v("普通类型")]),a("span",[e._v("1个礼包码，1个账号只能使用1次、该类礼包1个账号只能使用其中1个")])],1),a("p",[a("el-radio",{attrs:{label:"2"}},[e._v("万能类型")]),a("span",[e._v("1个礼包码，N个账号只能使用1次、该类礼包1个账号只能使用其中1个")])],1),a("p",[a("el-radio",{attrs:{label:"3"}},[e._v("福利类型")]),a("span",[e._v("1个礼包码，1个账号只能使用1次、该类礼包1个账号只能使用其中N个")])],1)])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("objFormSingle")}}},[e._v("创建礼包码")])],1)],1)],1)}),F=[],w={name:"coupon-createCode",props:{formData:{type:Object}},data:function(){return{aCoupon:[{id:"123",name:"礼包1"},{id:"124",name:"礼包2"},{id:"125",name:"礼包3"}],aChannels:[],aPlatform:[],objFormSingle:{},rules:{platform:[{required:!0,message:"请选择平台",trigger:"change"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],describe:[{required:!0,message:"请输入分类信息",trigger:"blur"}],num:[{required:!0,message:"请输入数量"}],minLevel:[{required:!0,message:"请输入使用最低等级",trigger:"blur"}],maxLevel:[{required:!0,message:"请输入使用最高等级",trigger:"blur"}],start:[{required:!0,message:"请选择时间",trigger:"change"}],end:[{required:!0,message:"请选择时间",trigger:"change"}],title:[{required:!0,message:"请输入邮件标题",trigger:"blur"}],content:[{required:!0,message:"请输入邮件内容",trigger:"blur"}],couponId:[{required:!0,message:"请选择礼包",trigger:"change"}],channels:[{required:!0,message:"请选择分发客户端",trigger:"change"}],type:[{required:!0,message:"请选择礼包类型",trigger:"change"}]}}},watch:{formData:{handler:function(){var e=JSON.parse(JSON.stringify(this.formData));e.platform=this.formData.platform.id,e.type+="",this.objFormSingle=e}},deep:!0},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;var o=JSON.parse(JSON.stringify(t.objFormSingle));t.$fetch.post(API.coupon.create_coupon_code,o).then((function(a){var o=a.data;200==o.status?(t.$emit("submitUpdate"),t.$refs[e].resetFields(),t.$message.success("修改成功 礼包批次号为：【".concat(o.data.sequenceId,"】"))):t.$message.error(o.desc)}))}))},fetchPlatformList:function(){var e=this;this.$fetch.post(API.coupon.platform_list).then((function(t){var a=t.data;200==a.status?e.aPlatform=a.data:e.$message.error(a.desc)}))},fetchChannelList:function(){var e=this;this.$fetch.post(API.anno.channels).then((function(t){var a=t.data;200==a.status?e.aChannels=a.data:e.$message.error(a.desc)}))},fetchCouponIdList:function(){var e=this;this.$fetch.post(API.coupon.coupon_id_list).then((function(t){var a=t.data;200==a.status?e.aCoupon=a.data:e.$message.error(a.desc)}))}},mounted:function(){this.fetchChannelList(),this.fetchPlatformList(),this.fetchCouponIdList();var e=JSON.parse(JSON.stringify(this.formData));e.platform=this.formData.platform.id,e.type+="",this.objFormSingle=e}},I=w,k=Object(c["a"])(I,y,F,!1,null,null,null),_=k.exports,$=a("2427"),x=a.n($),L=a("6e40");function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){Object(S["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={name:"create-id",components:{codeUpdate:_},props:{oriTab:{type:String,default:"create"}},data:function(){return{bDialogUpdate:!1,bDialogTime:!1,bDialogNum:!1,objSearch:{},objSingle:{},objTime:{},objNum:{},objRule:{appendTime:[{required:!0,message:"请选择时间",trigger:"change"}]},aTableData:[],objPager:{total:20,currentPage:1,pageSize:10}}},watch:{oriTab:{handler:function(){"codeShow"==this.oriTab&&this.fetchCouponList()}}},methods:{handleReset:function(){this.objSearch={}},handleSearch:function(){this.fetchCouponList()},handlePageChange:function(e){this.objPager.currentPage=e,this.fetchCouponList()},handleClickUpdate:function(e){if(this.objSingle=JSON.parse(JSON.stringify(e)),this.objSingle.channels){var t=[];e.channels.forEach((function(e){t.push(e.id+"")})),this.objSingle.channels=t}else this.objSingle.channels=[];this.bDialogUpdate=!0},handleClickSubmitUpdate:function(){this.bDialogUpdate=!1,this.fetchCouponList()},handleClickTime:function(e){this.objTime.sequenceId=e.sequenceId,this.bDialogTime=!0},handleClickSubmitTime:function(){var e=this,t=JSON.parse(JSON.stringify(this.objTime));this.$fetch.post(API.coupon.coupon_append_time,t).then((function(t){var a=t.data;200==a.status?(e.bDialogTime=!1,e.$message.success(a.desc)):e.$message.error(a.desc)}))},handleClickNum:function(e){this.objNum.sequenceId=e.sequenceId,this.objNum.appendNum=1,this.bDialogNum=!0},handleClickSubmitNum:function(){var e=this,t=JSON.parse(JSON.stringify(this.objNum));this.$fetch.post(API.coupon.coupon_append_num,t).then((function(t){var a=t.data;200==a.status?(e.bDialogNum=!1,e.$message.success(a.desc)):e.$message.error(a.desc)}))},handleClickDownload:function(e){var t={sequenceId:e.sequenceId};x()({method:"post",headers:{"content-type":"application/json; charset=utf-8"},responseType:"stream",url:L["a"]+API.coupon.get_cdkey,data:t}).then((function(t){console.log("response :",t);var a=new Blob(["\ufeff".concat(t.data)],{type:"text/plain;charset=utf-8"}),o=window.URL.createObjectURL(a),r=document.createElement("a");r.href=o,r.download="礼包批次".concat(e.sequenceId,".csv"),r.click(),window.URL.revokeObjectURL(o)}))},fetchCouponList:function(){var e=this,t=JSON.parse(JSON.stringify(this.objSearch));t=C({},t,{page:this.objPager.currentPage,pageSize:this.objPager.pageSize}),this.$fetch.post(API.coupon.coupon_list,t).then((function(t){var a=t.data;200==a.status?(e.aTableData=a.data.coupons,e.objPager.total=a.data.total):e.$message.error(a.desc)}))}},mounted:function(){var e=this;this.$on("closeDialog",(function(){e.bDialogUpdate=!1})),this.fetchCouponList()}},P=O,E=(a("ea0e"),Object(c["a"])(P,v,j,!1,null,"7e427b3c",null)),N=E.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-form",{attrs:{model:e.objSearch,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"礼包",prop:"couponId"}},[a("el-select",{attrs:{placeholder:"请选择礼包"},model:{value:e.objSearch.couponId,callback:function(t){e.$set(e.objSearch,"couponId",t)},expression:"objSearch.couponId"}},e._l(e.aCouponId,(function(e,t){return a("el-option",{key:t,attrs:{label:e.id,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isRes,expression:"!isRes"}]},[a("p",{staticStyle:{textAlign:"center"}},[e._v("暂无搜索结果！")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isRes,expression:"isRes"}]},[a("el-form",{ref:"objForm",attrs:{model:e.objForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"礼包内容"}},[a("el-button",{on:{click:function(t){return t.preventDefault(),e.addItem(t)}}},[e._v("添加")])],1),e._l(e.objForm.items,(function(t,o){return a("el-row",{key:o,staticStyle:{marginTop:"10px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:1,offset:2}},[a("span",{staticStyle:{lineHeight:"40px"}},[e._v(e._s(o+1))])]),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"道具",prop:"items."+o+".itemId","label-width":"60px",rules:{required:!0,message:"道具不能为空",trigger:"blur"}}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择道具"},model:{value:t.itemId,callback:function(a){e.$set(t,"itemId",a)},expression:"item.itemId"}},e._l(e.aItemList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.type+"-"+e.name,value:e.itemId}})})),1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"数量",prop:"items."+o+".num","label-width":"60px",rules:{required:!0,message:"数量不能为空",trigger:"blur"}}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:t.num,callback:function(a){e.$set(t,"num",a)},expression:"item.num"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{on:{click:function(a){return a.preventDefault(),e.removeItem(t)}}},[e._v("删除")])],1)],1)})),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("objForm")}}},[e._v("修改礼包ID")])],1)],2)],1)])},q=[],J={name:"create-id",props:{oriTab:{type:String,default:"create"}},data:function(){return{aCouponId:[],isRes:!1,objSearch:{couponId:""},aItemList:[],objForm:{id:"",items:[]},rules:{id:[{required:!0,message:"请输入id",trigger:"blur"}]}}},watch:{oriTab:{handler:function(){"idUpdate"==this.oriTab&&(this.fetchCouponIdList(),this.fetchItemList())}}},methods:{handleSearch:function(){this.objSearch.couponId?(this.isRes=!0,this.fetchList()):this.$message.erroe("请先选择礼包！")},fetchList:function(){var e=this,t=JSON.parse(JSON.stringify(this.objSearch));this.$fetch.post(API.coupon.select_coupon_id,t).then((function(t){var a=t.data;200==a.status?e.objForm={id:e.objSearch.couponId,items:a.data}:e.$message.error(a.desc)}))},removeItem:function(e){var t=this.objForm.items.indexOf(e);-1!==t&&this.objForm.items.splice(t,1)},addItem:function(){this.objForm.items.push({itemId:"",num:1})},submitForm:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return!1;var o=JSON.parse(JSON.stringify(t.objForm));t.$fetch.post(API.coupon.update_coupon_id,o).then((function(a){var o=a.data;200==o.status?(t.$refs[e].resetFields(),t.$message.success(o.desc)):t.$message.error(o.desc)}))}))},fetchItemList:function(){var e=this;this.$fetch.post(API.email.item_list).then((function(t){var a=t.data;200==a.status?e.aItemList=a.data:e.$message.error(a.desc)}))},fetchCouponIdList:function(){var e=this;this.$fetch.post(API.coupon.coupon_id_list).then((function(t){var a=t.data;if(200==a.status){var o=a.data;o.forEach((function(e){e.itemId=e.itemId+""})),e.aCouponId=o}else e.$message.error(a.desc)}))}},mounted:function(){this.fetchCouponIdList(),this.fetchItemList()}},H=J,U=(a("5e48"),Object(c["a"])(H,D,q,!1,null,"18213950",null)),A=U.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-form",{attrs:{model:e.objSearch,"label-width":"100px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"CD-KEY"}},[a("el-input",{attrs:{placeholder:"请输入礼包ID"},model:{value:e.objSearch.cdkey,callback:function(t){e.$set(e.objSearch,"cdkey",t)},expression:"objSearch.cdkey"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)],1)],1),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.aTableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"cdkey",label:"礼包cdkey","min-width":"100"}}),a("el-table-column",{attrs:{prop:"platform",label:"平台","min-width":"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.platform.name))])]}}])}),a("el-table-column",{attrs:{prop:"type",label:"礼包类型","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"couponId",label:"礼包id","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"describe",label:"分类信息","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"isUse",label:"使用状态","min-width":"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.user?"是":"否"))])]}}])}),a("el-table-column",{attrs:{prop:"useTime",label:"使用时间","min-width":"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.useTime))])]}}])}),a("el-table-column",{attrs:{prop:"serverId",label:"服务器id","min-width":"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"pid",label:"角色id 数组","min-width":"100","show-overflow-tooltip":""}})],1)],1)])},R=[],z={name:"id-list",props:{oriTab:{type:String,default:"create"}},data:function(){return{objSearch:{cdkey:""},aTableData:[]}},watch:{oriTab:{handler:function(){"idList"==this.oriTab&&this.fetchCouponIdList()}}},methods:{handleSearch:function(){this.fetchCouponIdList()},fetchCouponIdList:function(){var e=this,t=JSON.parse(JSON.stringify(this.objSearch));this.$fetch.post(API.coupon.select_cdkey,t).then((function(t){var a=t.data;200==a.status?e.aTableData=[a.data]:e.$message.error(a.desc)}))}},mounted:function(){}},B=z,K=(a("a02a"),Object(c["a"])(B,M,R,!1,null,"07808df5",null)),Y=K.exports,G={name:"coupon",components:{createId:u,createCode:g,codeShow:N,idUpdate:A,idList:Y},data:function(){return{actTab:"createId"}},methods:{}},Q=G,V=Object(c["a"])(Q,o,r,!1,null,"372f948a",null);t["default"]=V.exports},c208:function(e,t,a){},c221:function(e,t,a){},ea0e:function(e,t,a){"use strict";var o=a("c221"),r=a.n(o);r.a},ebc3:function(e,t,a){"use strict";var o=a("064e"),r=a("cc33");e.exports=function(e,t,a){t in e?o.f(e,t,r(0,a)):e[t]=a}},f010:function(e,t,a){"use strict";function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=chunk-cb7d326e.d4a37e1b.js.map